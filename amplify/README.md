# Getting Started with Amplify CLI

This directory was generated by [Amplify CLI](https://docs.amplify.aws/cli).

Helpful resources:

- Amplify documentation: https://docs.amplify.aws.
- Amplify CLI documentation: https://docs.amplify.aws/cli.
- More details on this folder & generated files: https://docs.amplify.aws/cli/reference/files.
- Join Amplify's community: https://amplify.aws/community/.

---

# üé§ Demo for ‚ÄúCDK + Amplify: El d√∫o perfecto para arquitecturas serverless avanzadas‚Äù ‚Äì AWS CDMX 2025

## Amplify api override

### Step 1: Understand How Amplify Generates the Table

When you define a model like this in your GraphQL schema:

```graphql
type Feedback @model @auth(rules: [{ allow: private, operations: [create, read] }]) {
  id: ID!
  user: String!
  message: String!
  sentiment: String @default(value: "neutral")
  createdAt: AWSDateTime
}
```

Amplify auto-generates a DynamoDB table named:

    <apiname><ModelName><Environment>

So in this case generates:

    notificationdemo.Feedback.dev

### Step 2: Override api to enable dynamoStreams on Feedback table

to [override the api](https://docs.amplify.aws/gen1/javascript/build-a-backend/graphqlapi/modify-amplify-generated-resources/) use:

```bash
amplify override api
```

## üß± Updated Pattern with EventBridge Pipe

    DynamoDB Stream ‚ûú EventBridge Pipe ‚ûú EventBridge Bus ‚ûú Rule ‚ûú Lambda/SNS

‚úÖ Advantages of Pipes:

- No Lambda needed to forward the stream to EventBridge.
- You can transform or filter events directly in the pipe.
- Native support for DynamoDB Streams as source, EventBridge EventBus as target.

## üß© Components Breakdown

| Component           | Type              | Purpose                                 |
| ------------------- | ----------------- | --------------------------------------- |
| DynamoDB Stream     | Source            | Emits change events                     |
| EventBridge Pipe    | Bridge            | Connects Stream ‚Üí Bus, allows filtering |
| EventBridge Bus     | Event Destination | Receives events from the pipe           |
| Rule                | Event Matcher     | Routes matched events to target         |
| Target (Lambda/SNS) | Event Consumer    | Reacts to matched events                |

### Step 1: Add custom resource

you need to add [custom CDK resource](https://docs.amplify.aws/gen1/react/tools/cli/custom/cdk/) as follow:

```bash
amplify add custom
```

```sh
? How do you want to define this custom resource? ‚Ä¶  (Use arrow keys or type to filter)
‚ùØ AWS CDK
  AWS CloudFormation
```

## Permissions:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "CloudFormationAccess",
      "Effect": "Allow",
      "Action": ["cloudformation:*"],
      "Resource": "*"
    },
    {
      "Sid": "S3AndS3ObjectLambdaAccess",
      "Effect": "Allow",
      "Action": ["s3:*", "s3-object-lambda:*"],
      "Resource": "*"
    },
    {
      "Sid": "SNSFullAccess",
      "Effect": "Allow",
      "Action": "sns:*",
      "Resource": "*"
    }
  ]
}
```
